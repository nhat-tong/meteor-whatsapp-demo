<ion-view view-title="Chats" cache-view="false">
    <ion-nav-buttons side="right">
        <button ng-click="vm.showChatModal()" class="button button-clear button-positive button-icon ion-ios-compose-outline"></button>
    </ion-nav-buttons>
    <ion-content>
        <ion-list>
            <ion-item
                    ng-repeat="chat in vm.chats | orderBy:'-lastMessage.timestamp'"
                    class="item-chat item-remove-animate item-avatar item-icon-right"
                    type="item-text-wrap"
                    href="#/tab/chats/{{chat._id}}">
                <img ng-src="{{chat | chatPicture}}">
                <h2>{{chat | chatName}}</h2>
                <ng-switch on="chat.lastMessage.type">
                    <div ng-switch-when="text">
                        <p>{{chat.lastMessage.text}}</p>
                    </div>
                    <div ng-switch-when="picture">
                        <p><img ng-src="{{chat.lastMessage.picture}}"/></p>
                    </div>
                </ng-switch>
                <span class="last-message-timestamp">{{chat.lastMessage.timestamp | calendar}}</span>
                <i class="icon ion-chevron-right icon-accessory"></i>
                <ion-option-button class="button-assertive" ng-click="vm.remove(chat)">
                    Delete
                </ion-option-button>
            </ion-item>
        </ion-list>
    </ion-content>
</ion-view>